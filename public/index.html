<!DOCTYPE html>
<html lang="ko">
    <head>
        <title>chat</title>
        <script>
            const ws = new WebSocket("ws://localhost:8001")

            function sayHi(){
                ws.send("Hello")
            }
            
            function inputEnter(){
                let key = event.key || event.keyCode;
             
                if (key === 'Enter' || key === 13) {
                    sendmessage();
                }
            }
            
            
            function sendmessage(){           
                const nickname= document.getElementById('nickname').value;
                const chat = document.getElementById('chattingchang');
                const message = document.getElementById('message').value;
                var new_ = document.createElement("div");
                
                if(message.trim().length*nickname.trim().length > 0){
                    fullmessage = nickname+": "+message
                    ///chat.innerHTML += "<div>"+fullmessage+"</div>"
                    chat.scrollTop=chat.scrollHeight;
                    document.getElementById("message").value="";
                    ws.send(fullmessage);
                }
            }

            function receivemessage(){
                const chat = document.createElement("div");
                const message = document.createTextNode(event.data);
                chat.appendChild(message)

                const chang = document.getElementById("chattingchang");
                chang.appendChild(chat)
            }

            ws.onmessage = receivemessage


            </script>
    </head>
    <body>
        <p><div id="chattingchang" style="width:412px; height:500px; border: 3px solid black; background-color: white; overflow:auto"></div></p>
        <p>닉네임 <input type="text" id="nickname"></p>
        <input type="text" size="50" id="message" onkeyup="inputEnter()">
        <button onclick="sendmessage()">전송</button>
    </body>

</html>
